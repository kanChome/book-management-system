# 機能仕様書: 書籍管理システム

**機能ブランチ**: `001-spec-md`
**作成日**: 2025-09-14
**ステータス**: ドラフト
**入力**: ユーザー説明: "@SPEC.md を確認し、仕様を明確化してください。"

## 実行フロー (main)
```
1. ユーザー説明からの入力解析
   → 空の場合: エラー「機能説明が提供されていません」
2. 説明から主要概念を抽出
   → 識別: アクター、アクション、データ、制約
3. 不明確な側面ごとに:
   → [要明確化: 具体的な質問]でマーク
4. ユーザーシナリオとテストセクションを記入
   → 明確なユーザーフローがない場合: エラー「ユーザーシナリオを決定できません」
5. 機能要件を生成
   → 各要件はテスト可能でなければならない
   → 曖昧な要件をマーク
6. 主要エンティティを識別（データが関与する場合）
7. レビューチェックリストを実行
   → [要明確化]がある場合: 警告「仕様に不確実性があります」
   → 実装詳細が見つかった場合: エラー「技術詳細を削除してください」
8. 戻り値: 成功（仕様はプランニングの準備完了）
```

---

## ⚡ クイックガイドライン
- ✅ ユーザーが何を必要とし、なぜ必要なのかに焦点を当てる
- ❌ 実装方法を避ける（技術スタック、API、コード構造なし）
- 👥 開発者ではなく、ビジネス関係者向けに書かれている

### セクション要件
- **必須セクション**: すべての機能で完成させる必要がある
- **オプションセクション**: 機能に関連する場合のみ含める
- セクションが適用されない場合は、完全に削除する（「N/A」として残さない）

---

## ユーザーシナリオとテスト *(必須)*

### 主要ユーザーストーリー
書籍管理システムの管理者として、書籍と著者の情報を効率的に管理したい。具体的には、新しい書籍や著者を登録し、既存の情報を更新し、著者に関連する書籍を簡単に検索できるようにしたい。

### 受け入れシナリオ
1. **Given** システムに著者が登録されている、**When** 管理者が新しい書籍を登録する、**Then** 書籍は少なくとも1人の著者と紐付けられて登録される
2. **Given** 書籍が「未出版」ステータスで登録されている、**When** 管理者が出版済みに変更する、**Then** ステータスが「出版済み」に更新される
3. **Given** 書籍が「出版済み」ステータスである、**When** 管理者が「未出版」に変更しようとする、**Then** エラーが表示され変更が拒否される
4. **Given** 著者が登録されている、**When** 管理者がその著者を検索する、**Then** その著者が執筆したすべての書籍のリストが表示される
5. **Given** 管理者が書籍を登録しようとする、**When** 価格に負の値を入力する、**Then** エラーが表示され登録が拒否される
6. **Given** 管理者が著者を登録しようとする、**When** 生年月日に未来の日付を入力する、**Then** エラーが表示され登録が拒否される

### エッジケース
- 同姓同名の著者が複数存在することが可能
- 書籍価格に上限値はない
- 1つの書籍に設定可能な著者数に制限はない

## 要件 *(必須)*

### 機能要件
- **FR-001**: システムは書籍情報（タイトル、価格、出版状況）を登録できなければならない
- **FR-002**: システムは書籍に最低1人の著者を紐付けなければならない
- **FR-003**: システムは書籍に複数の著者を紐付けることができなければならない
- **FR-004**: システムは著者情報（名前、生年月日）を登録できなければならない
- **FR-005**: システムは書籍の価格を0以上の値として検証しなければならない
- **FR-006**: システムは著者の生年月日を現在日付より過去として検証しなければならない
- **FR-007**: システムは出版済み書籍のステータスを未出版に変更することを防がなければならない
- **FR-008**: システムは著者に紐づくすべての書籍を取得できなければならない
- **FR-009**: システムは書籍情報を更新できなければならない
- **FR-010**: システムは著者情報を更新できなければならない
- **FR-011**: システムは書籍と著者の情報をRDBに永続化しなければならない

### 主要エンティティ
- **書籍**: 出版物を表し、タイトル、価格、出版状況を持つ。1つ以上の著者と関連付けられる
- **著者**: 書籍の執筆者を表し、名前と生年月日を持つ。0個以上の書籍と関連付けられる
- **書籍-著者関連**: 書籍と著者の多対多の関係を管理する

---

## レビュー＆受け入れチェックリスト
*GATE: main()実行中に自動チェックが実行される*

### コンテンツ品質
- [x] 実装詳細なし（言語、フレームワーク、API）
- [x] ユーザー価値とビジネスニーズに焦点を当てている
- [x] 非技術的なステークホルダー向けに書かれている
- [x] すべての必須セクションが完成している

### 要件の完全性
- [x] [要明確化]マーカーが残っていない
- [x] 要件がテスト可能で曖昧でない
- [x] 成功基準が測定可能
- [x] スコープが明確に境界付けられている
- [x] 依存関係と前提条件が識別されている

---

## 実行ステータス
*処理中にmain()によって更新される*

- [x] ユーザー説明を解析した
- [x] 主要概念を抽出した
- [x] 曖昧さをマークした
- [x] ユーザーシナリオを定義した
- [x] 要件を生成した
- [x] エンティティを識別した
- [x] レビューチェックリストをパスした

---

## 仕様の明確化事項

以下の事項が明確化されました：

1. **削除機能**: 不要（実装しない）
2. **検索機能**: 不要（著者に紐づく書籍の取得機能のみ実装）
3. **ページネーション**: 不要（実装しない）
4. **API認証**: 不要（認証なしのパブリックAPI）
5. **著者名の一意性**: 同姓同名の著者が存在可能
6. **書籍価格の上限**: 制限なし（0以上の任意の値）
7. **著者数の制限**: 制限なし（1つの書籍に複数の著者を設定可能）